<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Temperature map</title>
        <link href="https://api.mapbox.com/mapbox-gl-js/v2.3.0/mapbox-gl.css" rel="stylesheet">
        <script src="https://api.mapbox.com/mapbox-gl-js/v2.3.0/mapbox-gl.js"></script>
        <style>
            body { margin: 0; padding: 0; }
            #map { position: absolute; top: 0; bottom: 0; width: 100%; }
        </style>
    </head>
    <body>
        <div id="map"></div>
        <script src="interpolateHeatmapLayer.js"></script>
        <script>
            mapboxgl.accessToken = 'pk.eyJ1IjoibW9oaS1nYXRlIiwiYSI6ImNsbjRsdDhvcTAxeWgycXBmcTVjYjA4em4ifQ.yaTzeNt2gbG3Z_a-SkxmTQ'

            const geodata = 'https://raw.githubusercontent.com/GATE-Institute-Future-Cities/sofia-sensors/master/EXEA%20DATA/heatmap_geojson_file.geojson'

            (async () => {
                const response = await fetch(geodata);
                const Data = await response.json()
                
                const points = Data.features.map(feature => ({
                    lat: feature.geometry.coordinates[0],
                    lng: feature.geometry.coordinates[1],
                    val: feature.properties.value
                }));

                const map = new mapboxgl.Map({
                    container: 'map',
                    style: 'mapbox://styles/mapbox/light-v10',
                    center: [23.23, 42.622], // Set the initial center based on your data
                    zoom: 12, // Adjust the initial zoom level as needed
                });

                map.on('load', () => {
                    const layer = interpolateHeatmapLayer.create({
                        points: points,
                        layerId: 'airquality',
                    });
                    map.addLayer(layer);
                });
            })();

        </script>
    </body>
</html>